<!doctype html>
<html lang="en">
<head>
  {% load static %}
  {% load customtags %}

  <link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}" /> 
  
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link rel="stylesheet"
    href="https://owlcarousel2.github.io/OwlCarousel2/assets/owlcarousel/assets/owl.carousel.min.css">
  <link rel="stylesheet"
    href="https://owlcarousel2.github.io/OwlCarousel2/assets/owlcarousel/assets/owl.theme.default.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css">

  <title>Nav</title>
</head>

<body>
  {% if user.is_authenticated %}
  <section class="nav-slider-section">
    <div class="container">
      <div style="display:flex;justify-content:space-between">
        <a class="btn btn-success" href="{% url 'createBlog' %}"> Create Blog</a>
        <a class="btn btn-danger" href="{% url 'logout' %}"> Logout</a>
      </div>
      <div class="row"> 
        <div class="col-12">
          <div class="nav-slider-section-inner">
            <div class="nav-slider-tabs">
              <button class="nav-active">AP - Wire</button>
              <button >AP - News</button>
            </div>
            <div class="ns-slider-box-section">
              <div class="table-carousel owl-carousel owl-theme">
               
               {% for key,val in context_dict.items %}
               {% comment %} {{UserCustom.accessint}} {% endcomment %}
                {% if forloop.counter <= user.accessint %}
                <div class="ns-slider-box">   
                  <h5>{{forloop.counter}}. {{ key}}</h5>
                  <div class="ns-slider-box-table sortablecolumn">
                    <table class="table mytable"  id="ApWire_{{key|replaceSpacewithUnderScore }}">
                      <thead>
                        <tr>
                          <th>#</th>
                          <th>Title</th>
                          <th>Author</th>
                          <th>Date</th>
                          <th>Action</th>
                        </tr>
                      </thead>
                      <tbody id="tableBody_{{key|replaceSpacewithUnderScore }}" class="connectedSortable" >
                       <tr hidden>
                         <td></td>
                         <td></td>
                         <td></td>
                         <td></td>
                         <td></td>
                          </tr>
                        {% for v in val %}
                        <tr id="{{key|replaceSpacewithUnderScore }}_{{v.pk}}">
                          <th>{{forloop.counter}}</th>
                          <td>{{v.topic}}</td>
                          <td>{{v.author}}</td>
                          <td>{{v.date}}</td>
                          <td> <div class="new-row-control">
                            <a class="row-add editRow" id="editRow-{{v.pk}}-{{key|replaceSpacewithUnderScore }}" href={% url 'editBlog' v.pk %} ><i class="fa fa-edit"></i></a>
                            <button class="row-remove"><i class="fa fa-arrows"></i></button>
                          </div></td>
                        </tr>
                        {% endfor %}
                        <tr class="sort-disabled" style="background-color: #fff !important;">
                          <td></td>
                          <td></td>
                          <td></td>
                          <td></td>
                          <td></td>

                        </tr>
                        {% comment %} <tr>
                          <th>
                            <div class="new-row-control">
                              <button class="row-add addRow" id="addRow_{{key|replaceSpacewithUnderScore }}"><i class="fa fa-check"></i></button>
                              <button class="row-remove"><i class="fa fa-times"></i></button>
                            </div>
                          </th>
                          <td><input type="text" id="title_{{key|replaceSpacewithUnderScore }}" ></td>
                          <td><input type="text" id="author_{{key|replaceSpacewithUnderScore }}"></td>
                          <td><input type="date" id="date_{{key|replaceSpacewithUnderScore }}"></td>
                        </tr> {% endcomment %}
                      </tbody>
                    </table>
                  </div>
                  <div class="add-row-table">
                    <!-- <a href="#">+ Add Row</a> -->
                  </div>
                </div>
              {% endif %}
                {% endfor %}

                <!--
                </div>
              </div>
                <div class="ns-slider-box">
                  <h5>2. Content Pitching</h5>
                  <div class="ns-slider-box-table">
                    <table class="table">
                      <thead>
                        <tr>
                          <th>#</th>
                          <th>Title</th>
                          <th>Author</th>
                          <th>Date</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>1</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>3</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>5</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>6</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>7</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>8</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>
                            <div class="new-row-control">
                              <button class="row-add"><i class="fa fa-check"></i></button>
                              <button class="row-remove"><i class="fa fa-times"></i></button>
                            </div>
                          </th>
                          <td><input type="text"></td>
                          <td><input type="text"></td>
                          <td><input type="text"></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <div class="add-row-table">
                    <a href="#">+ Add Row</a>
                  </div>
                </div>
                <div class="ns-slider-box">
                  <h5>3. Content Pitching</h5>
                  <div class="ns-slider-box-table">
                    <table class="table">
                      <thead>
                        <tr>
                          <th>#</th>
                          <th>Title</th>
                          <th>Author</th>
                          <th>Date</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>1</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>3</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>5</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>6</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>7</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>8</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>
                            <div class="new-row-control">
                              <button class="row-add"><i class="fa fa-check"></i></button>
                              <button class="row-remove"><i class="fa fa-times"></i></button>
                            </div>
                          </th>
                          <td><input type="text"></td>
                          <td><input type="text"></td>
                          <td><input type="text"></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <div class="add-row-table">
                    <a href="#">+ Add Row</a>
                  </div>
                </div>
                <div class="ns-slider-box">
                  <h5>4. Content Pitching</h5>
                  <div class="ns-slider-box-table">
                    <table class="table">
                      <thead>
                        <tr>
                          <th>#</th>
                          <th>Title</th>
                          <th>Author</th>
                          <th>Date</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>1</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>3</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>5</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>6</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>7</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>8</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>
                            <div class="new-row-control">
                              <button class="row-add"><i class="fa fa-check"></i></button>
                              <button class="row-remove"><i class="fa fa-times"></i></button>
                            </div>
                          </th>
                          <td><input type="text"></td>
                          <td><input type="text"></td>
                          <td><input type="text"></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <div class="add-row-table">
                    <a href="#">+ Add Row</a>
                  </div>
                </div>
                <div class="ns-slider-box">
                  <h5>5. Content Pitching</h5>
                  <div class="ns-slider-box-table">
                    <table class="table">
                      <thead>
                        <tr>
                          <th>#</th>
                          <th>Title</th>
                          <th>Author</th>
                          <th>Date</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>1</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>3</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>5</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>6</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>7</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>8</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>
                            <div class="new-row-control">
                              <button class="row-add"><i class="fa fa-check"></i></button>
                              <button class="row-remove"><i class="fa fa-times"></i></button>
                            </div>
                          </th>
                          <td><input type="text"></td>
                          <td><input type="text"></td>
                          <td><input type="text"></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <div class="add-row-table">
                    <a href="#">+ Add Row</a>
                  </div>
                </div>
                <div class="ns-slider-box">
                  <h5>6. Content Pitching</h5>
                  <div class="ns-slider-box-table">
                    <table class="table">
                      <thead>
                        <tr>
                          <th>#</th>
                          <th>Title</th>
                          <th>Author</th>
                          <th>Date</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>1</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>3</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>5</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>6</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>7</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>8</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>
                            <div class="new-row-control">
                              <button class="row-add"><i class="fa fa-check"></i></button>
                              <button class="row-remove"><i class="fa fa-times"></i></button>
                            </div>
                          </th>
                          <td><input type="text"></td>
                          <td><input type="text"></td>
                          <td><input type="text"></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <div class="add-row-table">
                    <a href="#">+ Add Row</a>
                  </div>
                </div>
                <div class="ns-slider-box">
                  <h5>7. Content Pitching</h5>
                  <div class="ns-slider-box-table">
                    <table class="table">
                      <thead>
                        <tr>
                          <th>#</th>
                          <th>Title</th>
                          <th>Author</th>
                          <th>Date</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>1</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>2</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>3</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>4</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>5</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>6</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>7</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>8</th>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                          <td>Lorem ipsum</td>
                        </tr>
                        <tr>
                          <th>
                            <div class="new-row-control">
                              <button class="row-add"><i class="fa fa-check"></i></button>
                              <button class="row-remove"><i class="fa fa-times"></i></button>
                            </div>
                          </th>
                          <td><input type="text"></td>
                          <td><input type="text"></td>
                          <td><input type="text"></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <div class="add-row-table">
                    <a href="#">+ Add Row</a>
                  </div>
                </div> -->



              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->

  <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>
  <script src="https://owlcarousel2.github.io/OwlCarousel2/assets/owlcarousel/owl.carousel.js"></script>
  <script src="{% static 'js/custom.js'%}"></script>
  {% comment %} <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script> {% endcomment %}
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="https://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>


  <script>
    if (typeof jQuery.ui !== 'undefined'){
      console.log("Jquery ui not loaded")
    }  
      $(document).on('click','.addRow',function(){
          var id = $(this).attr('id').slice(7,)
          console.log(id)
          var title = $("#title_"+id).val()
          var author = $("#author_"+id).val()
          var date = $("#date_"+id).val()

          if(title == "" || author == "" || date == ""){
            alert("Please fill all the values")
          }else{
            $.ajax({
                url : "saveTableRow/"+id+"/", // Url of backend (can be python, php, etc..)
                type: "POST", // data type (can be get, post, put, delete)
                data : {'title':title,'author':author,'date':date}, // data in json format
          
                success: function(response, textStatus, jqXHR) {
                  console.log(response);

                  $(`#tableBody_${id} tr:last`).remove();
                  var totalRows = $(`#tableBody_${id} tr`).length;
                  $(`#tableBody_${id}`).append(
                    `
                        <tr id="${id}_${response.pk}">
                          <th>${totalRows+1}</th>
                          <td>${response.title}</td>
                          <td>${response.author}</td>
                          <td>${response.date}</td>
                          <td> <div class="new-row-control">
                            <button class="row-add editRow" id="editRow-${response.pk}-${id}"><i class="fa fa-edit"></i></button>
                            <button class="row-remove"><i class="fa fa-arrows"></i></button>
                          </div></td>
                        </tr>
                    `

                  )
                  $(`#tableBody_${id}`).append(
                    `
                    <tr>
                          <th>
                            <div class="new-row-control">
                              <button class="row-add addRow" id="addRow_${id}"><i class="fa fa-check"></i></button>
                              <button class="row-remove"><i class="fa fa-times"></i></button>
                            </div>
                          </th>
                          <td><input type="text" id="title_${id}" ></td>
                          <td><input type="text" id="author_${id}"></td>
                          <td><input type="date" id="date_${id}"></td>
                        </tr>
                    `
                  )
                  
                },
            
             });
          }
          
      })

      {% comment %} id="editRow-{{v.pk}}-{{key|replaceSpacewithUnderScore }}" {% endcomment %}
      
      $(document).on('click','.editRow',function(){
          var keys = $(this).attr('id').split('-')
       
          
          var id = keys[1]
          
          var tableName = keys[2]
        
          $.ajax({
            url: "getRowData/"+id+"/"+tableName+"/",
            success: function(data){ 
                console.log(data)
                $(`#${keys[2]}_${keys[1]}`).children('td').remove()
                $(`#${keys[2]}_${keys[1]}`).append(
                  `
                
                    
                    
                    <td><input type="text" value="${data.title}" id="title_${tableName}_${id}" ></td>
                    <td><input type="text" value="${data.author}" id="author_${tableName}_${id}"></td>
                    <td><input type="date" value="${data.date}" id="date_${tableName}_${id}"></td>
                    <td>
                      <div class="new-row-control">
                        <button class="row-add addEditRow" id="addEditRow-${id}-${tableName}"><i class="fa fa-check"></i></button>
                        
                      </div>
                    </td>
                  `
                )
            },
            error: function(){
              alert("There was an error");
            }
          });

          $(document).on('click','.editRow',function(){
          var keys = $(this).attr('id').split('-')
       
          
          var id = keys[1]
          
          var tableName = keys[2]
        
          $.ajax({
            url: "getRowData/"+id+"/"+tableName+"/",
            success: function(data){ 
                console.log(data)
                $(`#${keys[2]}_${keys[1]}`).children('td').remove()
                $(`#${keys[2]}_${keys[1]}`).append(
                  `
                    <td><input type="text" value="${data.title}" id="title_${tableName}_${id}" ></td>
                    <td><input type="text" value="${data.author}" id="author_${tableName}_${id}"></td>
                    <td><input type="date" value="${data.date}" id="date_${tableName}_${id}"></td>
                    <td>
                      <div class="new-row-control">
                        <button class="row-add addEditRow" id="addEditRow-${id}-${tableName}"><i class="fa fa-check"></i></button>
                        
                      </div>
                    </td>
                  `
                )
            },
            error: function(){
              alert("There was an error");
            }
          });
      })






      $(document).on('click','.addEditRow',function(){
        var keys = $(this).attr('id').split('-')
        var id = keys[1]
        var tableName = keys[2] 
        console.log(id)
        console.log(keys)
        var title = $("#title_"+tableName+"_"+id).val()
        var author = $("#author_"+tableName+"_"+id).val()
        var date = $("#date_"+tableName+"_"+id).val()
        $.ajax({
          url: "editData/"+id+"/"+tableName+"/",
          type:'POST',
          data:{'title':title,'author':author,'date':date},
          success: function(data){ 
              console.log(data)
            
              $(`#${keys[2]}_${keys[1]}`).children('td').remove()
              $(`#${keys[2]}_${keys[1]}`).append(
                `

                  <td>${data.title}</td>
                  <td>${data.author}</td>
                  <td>${data.date}</td>
                  
                  <td> <div class="new-row-control">
                    <button class="row-add editRow" id="editRow-${id}-${tableName}"><i class="fa fa-edit"></i></button>
                    <button class="row-remove"><i class="fa fa-arrows"></i></button>
                  </div></td>
                `
              ) 
          },
          error: function(){
            alert("There was an error");
          }
        });
    })



    })


    $(document).ready(function() {
      $("tbody.connectedSortable").sortable({
        connectWith: ".connectedSortable",
        helper: "clone",
        items: ">*:not(.sort-disabled)",
        cursor: "move",
        zIndex: 99999,
        // items: ">*:not(.sort-disabled)",
        receive: function(event, ui) {
          /* here you can access the dragged row via ui.item
             ui.item has been removed from the other table, and added to "this" table
          */
          console.log($(this))
           var addedTo = $(this).closest("table.mytable")
            
            
            dataa=ui.item[0]
      
            dropidArray = ui.item[0].id.split("_")
            dropid = dropidArray[dropidArray.length - 1]
            addedto = addedTo.attr('id').slice(7,)
            var idCounter = 0
            {% comment %} $("table.mytable").each(function(){
              console.log($(this).attr('id'))
              console.log(addedTo.attr('id'))
                if($(this).attr('id') == addedTo.attr('id')){
                    return false;
                }
                idCounter = idCounter + 1 
            })
            
            console.log("idcounter:"+idCounter) {% endcomment %}
            


            dropidArray.pop()
            console.log(dropidArray)
            removedfrom = dropidArray.join('_')
            
       
            console.log(addedto)
            console.log(removedfrom)

            $.ajax({
              url : "draganddrop/"+dropid+"/"+removedfrom+"/"+addedto+"/", // Url of backend (can be python, php, etc..)
              type: "POST", // data type (can be get, post, put, delete)
              data : {},
              success:function(response){
                console.log(response)
              }
            }) 
            
        }
      }
      );

      
    });
  
  {% endif %}
  </script>
</body>

</html>